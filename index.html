<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>おえかきボード</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>
</head>

<body>
    <!-- Start Screen -->
    <div id="start-screen" class="start-screen">
        <div class="start-card">
            <h1>🎨 おえかきボード</h1>
            <div class="start-options">
                <div class="option-group">
                    <h2>キャンバスモード</h2>
                    <div class="ratio-selector">
                        <button class="ratio-btn" data-w="500" data-h="500">1:1</button>
                        <button class="ratio-btn" data-w="800" data-h="600">4:3</button>
                        <button class="ratio-btn" data-w="1280" data-h="720">16:9</button>
                    </div>
                    <div class="custom-size">
                        <input type="number" id="canvasWidth" placeholder="幅" value="800">
                        <span>x</span>
                        <input type="number" id="canvasHeight" placeholder="高さ" value="600">
                    </div>
                    <button id="startCanvasBtn" class="primary-btn">おえかきをはじめる</button>
                </div>

                <div class="divider">
                    <span>または</span>
                </div>

                <div class="option-group">
                    <h2>画像モード</h2>
                    <p>好きな写真におえかきしよう！</p>
                    <input type="file" id="startImageLoader" accept="image/*" hidden>
                    <button id="startImageBtn" class="secondary-btn">画像を選ぶ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app-container" class="app-container" style="display: none;">
        <!-- Left Sidebar: Tools & Settings -->
        <div class="sidebar left-sidebar">
            <div class="logo">🎨 おえかきボード</div>

            <div class="control-group">
                <label>カラーテーマ</label>
                <div id="presetTabs" class="preset-tabs">
                    <!-- Preset tabs generated by JS -->
                </div>
            </div>

            <div class="control-group">
                <label>ツール</label>
                <button class="tool-btn active" data-tool="line">✏️ ペン</button>
                <button class="tool-btn" data-tool="dotted">⋯ 点線</button>
                <button class="tool-btn" data-tool="tone">░ トーン</button>
                <button class="tool-btn" data-tool="eraser">🧼 消しゴム</button>
            </div>

            <div id="pattern-group" class="control-group" style="display: none;">
                <label>パターン</label>
                <button class="pattern-btn active" data-pattern="dot">● ドット</button>
                <button class="pattern-btn" data-pattern="stripe">/// ストライプ</button>
                <button class="pattern-btn" data-pattern="solid">■ ベタ</button>
            </div>

            <div class="control-group">
                <label>エフェクト</label>
                <button class="effect-btn" data-effect="wobbly">〰️ もこもこ</button>
                <button class="effect-btn" data-effect="outline">🔲 ふちどり</button>
                <button class="effect-btn" data-effect="shadow">👥 かげ</button>
                <button class="effect-btn" data-effect="neon">✨ ネオン</button>
            </div>

            <div class="control-group">
                <label>ペンの太さ</label>
                <input type="range" id="sizeSlider" min="1" max="50" value="5">
            </div>

            <div class="control-group">
                <label>ゆれ具合</label>
                <input type="range" id="wobbleSlider" min="0" max="20" value="2">
            </div>

            <div class="control-group">
                <label>ゆれ速度</label>
                <input type="range" id="wobbleSpeedSlider" min="0" max="20" value="5">
            </div>

            <div class="spacer"></div>

            <div class="control-group">
                <button id="backToStartBtn" class="secondary-btn">🏠 ホームに戻る</button>
            </div>
        </div>

        <!-- Center: Canvas -->
        <div class="canvas-area">
            <!-- Left Sidebar Toggle -->
            <button id="leftSidebarToggle" class="sidebar-toggle left" title="左サイドバーを開閉">◀</button>

            <!-- Right Sidebar Toggle -->
            <button id="rightSidebarToggle" class="sidebar-toggle right" title="右サイドバーを開閉">▶</button>

            <div class="canvas-wrapper">
                <canvas id="drawingCanvas"></canvas>
            </div>

            <!-- Zoom Controls (moved to bottom) -->
            <div class="zoom-controls">
                <button id="zoomOutBtn" class="zoom-btn" title="縮小">−</button>
                <input type="range" id="zoomSlider" min="25" max="200" value="100" step="5">
                <span id="zoomPercent">100%</span>
                <button id="zoomInBtn" class="zoom-btn" title="拡大">+</button>
                <button id="zoomResetBtn" class="zoom-btn" title="リセット">⊙</button>
                <div class="divider-v" style="width: 1px; height: 24px; background: #ddd; margin: 0 4px;"></div>
                <button id="panBtn" class="zoom-btn" title="手のひらツール (Space)">✋</button>
            </div>

            <!-- Floating Controls -->
            <div class="canvas-controls">
                <button id="undoBtn" class="canvas-btn" title="元に戻す">↩️</button>
                <button id="redoBtn" class="canvas-btn" title="やり直す">↪️</button>
                <div class="divider-v"></div>
                <button id="clearBtn" class="canvas-btn danger" title="すべて消去">🗑️</button>
                <button id="exportBtn" class="action-btn">💾 書き出し</button>
            </div>
        </div>

        <!-- Right Sidebar: Layers & Color Palette -->
        <div class="sidebar right-sidebar">
            <div class="control-group vertical">
                <label>レイヤー</label>
                <div id="layerPanel" class="layer-panel">
                    <!-- Layers generated by JS -->
                </div>
            </div>

            <div class="control-group vertical">
                <label>パレット</label>
                <div id="colorPalette" class="color-palette vertical">
                    <!-- Colors generated by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Dialog -->
    <div id="confirmDialog" class="confirm-dialog">
        <div class="confirm-content">
            <p id="confirmMessage">ホームに戻りますか？<br>（描いた絵は消えてしまいます）</p>
            <div class="confirm-buttons">
                <button id="confirmOk" class="confirm-btn ok-btn">OK</button>
                <button id="confirmCancel" class="confirm-btn cancel-btn">キャンセル</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>